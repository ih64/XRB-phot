Changelog
===========

0.3.8 (unreleased)
------------------

- Nothing changed yet.


0.3.7 (2013-12-23)
------------------

- Avoid using ``Popen.stdout`` directly in the version.py SVN revision
  auto-update script to avoid possible ResourceWarnings on Python >= 3.2.
  See https://github.com/spacetelescope/PyFITS/issues/45


0.3.6 (2013-11-21)
------------------

- Fixed a syntax error in Python 3 that was introduced in 0.3.5.  This
  could occur very early in the setup such that it bailed before even 2to3
  could run on the rest of the package.


0.3.5 (2013-11-18)
------------------

- Fixed an obscure issue that could occur when trying to install with
  easy_install on Python 2 systems that have lib2to3 installed but have never
  used it.


0.3.4 (2013-07-31)
------------------

- Updated the check for ``__loader__`` added in v0.3.3 to only perform
  that check on Python >= 3.3, since the issue doesn't apply to older
  Python versions.


0.3.3 (2013-07-25)
------------------

- Updated the import-time SVN revision update mechanism in the ``version.py``
  module generated by the ``version_setup_hook`` to avoid running when not in
  a dev version of the package.  This saves time on importing released
  packages when installed on users' systems.

- Added a workaround to a bug on Python 3.3 that could cause stsci.distutils
  to crash during installation.


0.3.2 (2013-03-27)
------------------

- Fixed a bug in the version hook that could occur if the svnversion command
  fails.

- Updated the template for the version.py module generated by the version hook
  so that ``from .version import *`` will work for applications.

- Added a ``__vdate__`` variable in version.py which may contain a release
  date string by specifying a ``vdate`` option in the ``[metadata]`` section
  of setup.cfg.

- Added a ``stsci_distutils_version`` variable in version.py containing the
  version of stsci.distutils used to generate the file--useful primarily for
  debugging purposes.

- Version 0.3.1 added a new zest.releaser hooks to ensure that source
  distributes are created as tar.gz files instead of zip files--this was left
  out of the changelog for 0.3.1.

- The tar.gz zest.releaser hook is updated in 0.3.2 to only run on stsci
  packages.


0.3.1 (2012-06-28)
------------------

- Fixed a bug where console output from svn-related programs was assumed to be
  ascii, leading to possible crashes on non-English systems.


0.3 (2012-02-20)
----------------

- The ``glob_data_files`` hook became a pre-command hook for the install_data
  command instead of being a setup-hook.  This is to support the additional
  functionality of requiring data_files with relative destination paths to be
  install relative to the package's install path (i.e. site-packages).

- Dropped support for and deprecated the easier_install custom command.
  Although it should still work, it probably won't be used anymore for
  stsci_python packages.

- Added support for the ``build_optional_ext`` command, which replaces/extends
  the default ``build_ext`` command.  See the README for more details.

- Added the ``tag_svn_revision`` setup_hook as a replacement for the
  setuptools-specific tag_svn_revision option to the egg_info command.  This
  new hook is easier to use than the old tag_svn_revision option: It's
  automatically enabled by the presence of ``.dev`` in the version string, and
  disabled otherwise.

- The ``svn_info_pre_hook`` and ``svn_info_post_hook`` have been replaced with
  ``version_pre_command_hook`` and ``version_post_command_hook`` respectively.
  However, a new ``version_setup_hook``, which has the same purpose, has been
  added.  It is generally easier to use and will give more consistent results
  in that it will run every time setup.py is run, regardless of which command
  is used.  ``stsci.distutils`` itself uses this hook--see the `setup.cfg` file
  and `stsci/distutils/__init__.py` for example usage.

- Instead of creating an `svninfo.py` module, the new ``version_`` hooks create
  a file called `version.py`.  In addition to the SVN info that was included
  in `svninfo.py`, it includes a ``__version__`` variable to be used by the
  package's `__init__.py`.  This allows there to be a hard-coded
  ``__version__`` variable included in the source code, rather than using
  pkg_resources to get the version.

- In `version.py`, the variables previously named ``__svn_version__`` and
  ``__full_svn_info__`` are now named ``__svn_revision__`` and
  ``__svn_full_info__``.

- Fixed a bug when using stsci.distutils in the installation of other packages
  in the ``stsci.*`` namespace package.  If stsci.distutils was not already
  installed, and was downloaded automatically by distribute through the
  setup_requires option, then ``stsci.distutils`` would fail to import.  This
  is because the way the namespace package (nspkg) mechanism currently works,
  all packages belonging to the nspkg *must* be on the import path at initial
  import time.

  So when installing stsci.tools, for example, if ``stsci.tools`` is imported
  from within the source code at install time, but before ``stsci.distutils``
  is downloaded and added to the path, the ``stsci`` package is already
  imported and can't be extended to include the path of ``stsci.distutils``
  after the fact.  The easiest way of dealing with this, it seems, is to
  delete ``stsci`` from ``sys.modules``, which forces it to be reimported, now
  the its ``__path__`` extended to include ``stsci.distutil``'s path.

- Added zest.releaser hooks for tweaking the development version string
  template, and for uploading new releases to STScI's local package index.


0.2.2 (2011-11-09)
------------------

- Fixed check for the issue205 bug on actual setuptools installs; before it
  only worked on distribute.  setuptools has the issue205 bug prior to version
  0.6c10.

- Improved the fix for the issue205 bug, especially on setuptools.
  setuptools, prior to 0.6c10, did not back of sys.modules either before
  sandboxing, which causes serious problems.  In fact, it's so bad that it's
  not enough to add a sys.modules backup to the current sandbox: It's in fact
  necessary to monkeypatch setuptools.sandbox.run_setup so that any subsequent
  calls to it also back up sys.modules.


0.2.1 (2011-09-02)
------------------

- Fixed the dependencies so that setuptools is requirement but 'distribute'
  specifically.  Previously installation could fail if users had plain
  setuptools installed and not distribute

0.2 (2011-08-23)
------------------

- Initial public release
